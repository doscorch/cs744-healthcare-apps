{"ast":null,"code":"import _regeneratorRuntime from\"/home/diedrick.nathan/cs744-healthcare-apps/healthcare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/diedrick.nathan/cs744-healthcare-apps/healthcare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{ERROR}from\"../errorHandling\";import client from\"../feathersClient\";var users=client.service('users');// call api to register user\nexport var registerUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(username,password,firstName,lastName){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return users.create({\"username\":username,\"password\":password,\"firstName\":firstName,\"lastName\":lastName,userRole:\"patient\"},{});case 2:return _context.abrupt(\"return\",_context.sent);case 3:case\"end\":return _context.stop();}}},_callee);}));return function registerUser(_x,_x2,_x3,_x4){return _ref.apply(this,arguments);};}();// call api to get users\nexport var getUsers=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",users.find().then(function(u){return u.data;}));case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function getUsers(){return _ref2.apply(this,arguments);};}();// call api to register user by username\nexport var getUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(username){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:return _context3.abrupt(\"return\",users.find({query:{username:username}}).then(function(u){return u.data.length?u.data[0]:undefined;}));case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function getUser(_x5){return _ref3.apply(this,arguments);};}();// call api to update user\nexport var updateUser=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(user){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return users.update(user._id,user,{});case 2:return _context4.abrupt(\"return\",_context4.sent);case 3:case\"end\":return _context4.stop();}}},_callee4);}));return function updateUser(_x6){return _ref4.apply(this,arguments);};}();// call api to patch user\nexport var patchUser=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(userPartial){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return users.patch(userPartial._id,userPartial,{});case 2:return _context5.abrupt(\"return\",_context5.sent);case 3:case\"end\":return _context5.stop();}}},_callee5);}));return function patchUser(_x7){return _ref5.apply(this,arguments);};}();// call api to login user\nexport var loginUser=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(username,password){var _auth$user,_auth$user2,auth,_auth,_error$message,message;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;if(!(!username&&!password)){_context6.next=8;break;}_context6.next=4;return client.reAuthenticate();case 4:auth=_context6.sent;return _context6.abrupt(\"return\",{userId:(_auth$user=auth.user)===null||_auth$user===void 0?void 0:_auth$user._id,username:(_auth$user2=auth.user)===null||_auth$user2===void 0?void 0:_auth$user2.username,error:false});case 8:_context6.next=10;return client.authenticate({strategy:'local',username:username,password:password});case 10:_auth=_context6.sent;return _context6.abrupt(\"return\",{user:_auth.user,error:false});case 12:_context6.next=19;break;case 14:_context6.prev=14;_context6.t0=_context6[\"catch\"](0);console.log(_context6.t0);message=(_error$message=_context6.t0===null||_context6.t0===void 0?void 0:_context6.t0.message)!==null&&_error$message!==void 0?_error$message:ERROR;return _context6.abrupt(\"return\",{error:message});case 19:case\"end\":return _context6.stop();}}},_callee6,null,[[0,14]]);}));return function loginUser(_x8,_x9){return _ref6.apply(this,arguments);};}();// logout user on client\nexport var logout=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return client.logout();case 2:return _context7.abrupt(\"return\",_context7.sent);case 3:case\"end\":return _context7.stop();}}},_callee7);}));return function logout(){return _ref7.apply(this,arguments);};}();","map":{"version":3,"sources":["/home/diedrick.nathan/cs744-healthcare-apps/healthcare/client/src/auth/usersService.js"],"names":["ERROR","client","users","service","registerUser","username","password","firstName","lastName","create","userRole","getUsers","find","then","u","data","getUser","query","length","undefined","updateUser","user","update","_id","patchUser","userPartial","patch","loginUser","reAuthenticate","auth","userId","error","authenticate","strategy","console","log","message","logout"],"mappings":"qWACA,OAASA,KAAT,KAAsB,kBAAtB,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CAEA,GAAMC,CAAAA,KAAK,CAAGD,MAAM,CAACE,OAAP,CAAe,OAAf,CAAd,CAEA;AACA,MAAO,IAAMC,CAAAA,YAAY,0FAAG,iBAAOC,QAAP,CAAiBC,QAAjB,CAA2BC,SAA3B,CAAsCC,QAAtC,wIACXN,CAAAA,KAAK,CAACO,MAAN,CAAa,CAAE,WAAYJ,QAAd,CAAwB,WAAYC,QAApC,CAA8C,YAAaC,SAA3D,CAAsE,WAAYC,QAAlF,CAA4FE,QAAQ,CAAE,SAAtG,CAAb,CAAgI,EAAhI,CADW,6GAAH,kBAAZN,CAAAA,YAAY,wDAAlB,CAIP;AACA,MAAO,IAAMO,CAAAA,QAAQ,2FAAG,yKACbT,KAAK,CAACU,IAAN,GAAaC,IAAb,CAAkB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACC,IAAN,EAAnB,CADa,0DAAH,kBAARJ,CAAAA,QAAQ,2CAAd,CAIP;AACA,MAAO,IAAMK,CAAAA,OAAO,2FAAG,kBAAOX,QAAP,uJACZH,KAAK,CAACU,IAAN,CAAW,CACdK,KAAK,CAAE,CACHZ,QAAQ,CAAEA,QADP,CADO,CAAX,EAIJQ,IAJI,CAIC,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACC,IAAF,CAAOG,MAAP,CAAgBJ,CAAC,CAACC,IAAF,CAAO,CAAP,CAAhB,CAA4BI,SAAhC,EAJF,CADY,0DAAH,kBAAPH,CAAAA,OAAO,8CAAb,CAQP;AACA,MAAO,IAAMI,CAAAA,UAAU,2FAAG,kBAAOC,IAAP,6IACTnB,CAAAA,KAAK,CAACoB,MAAN,CAAaD,IAAI,CAACE,GAAlB,CAAuBF,IAAvB,CAA6B,EAA7B,CADS,iHAAH,kBAAVD,CAAAA,UAAU,8CAAhB,CAIP;AACA,MAAO,IAAMI,CAAAA,SAAS,2FAAG,kBAAOC,WAAP,6IACRvB,CAAAA,KAAK,CAACwB,KAAN,CAAYD,WAAW,CAACF,GAAxB,CAA6BE,WAA7B,CAA0C,EAA1C,CADQ,iHAAH,kBAATD,CAAAA,SAAS,8CAAf,CAIP;AACA,MAAO,IAAMG,CAAAA,SAAS,2FAAG,kBAAOtB,QAAP,CAAiBC,QAAjB,yMAEb,CAACD,QAAD,EAAa,CAACC,QAFD,kDAGIL,CAAAA,MAAM,CAAC2B,cAAP,EAHJ,QAGTC,IAHS,iDAIN,CACHC,MAAM,aAAED,IAAI,CAACR,IAAP,qCAAE,WAAWE,GADhB,CAEHlB,QAAQ,cAAEwB,IAAI,CAACR,IAAP,sCAAE,YAAWhB,QAFlB,CAGH0B,KAAK,CAAE,KAHJ,CAJM,iCAUI9B,CAAAA,MAAM,CAAC+B,YAAP,CAAoB,CACjCC,QAAQ,CAAE,OADuB,CAEjC5B,QAAQ,CAAEA,QAFuB,CAGjCC,QAAQ,CAAEA,QAHuB,CAApB,CAVJ,SAUTuB,KAVS,iDAeN,CACHR,IAAI,CAAEQ,KAAI,CAACR,IADR,CAEHU,KAAK,CAAE,KAFJ,CAfM,+FAqBjBG,OAAO,CAACC,GAAR,eACIC,OAtBa,mEAsBH,aAAOA,OAtBJ,iDAsBepC,KAtBf,kCAuBV,CACH+B,KAAK,CAAEK,OADJ,CAvBU,yEAAH,kBAATT,CAAAA,SAAS,kDAAf,CA6BP;AACA,MAAO,IAAMU,CAAAA,MAAM,2FAAG,+JACLpC,CAAAA,MAAM,CAACoC,MAAP,EADK,iHAAH,kBAANA,CAAAA,MAAM,2CAAZ","sourcesContent":["\nimport { ERROR } from \"../errorHandling\";\nimport client from \"../feathersClient\";\n\nconst users = client.service('users');\n\n// call api to register user\nexport const registerUser = async (username, password, firstName, lastName) => {\n    return await users.create({ \"username\": username, \"password\": password, \"firstName\": firstName, \"lastName\": lastName, userRole: \"patient\" }, {});\n}\n\n// call api to get users\nexport const getUsers = async () => {\n    return users.find().then(u => u.data)\n}\n\n// call api to register user by username\nexport const getUser = async (username) => {\n    return users.find({\n        query: {\n            username: username\n        }\n    }).then(u => u.data.length ? u.data[0] : undefined)\n}\n\n// call api to update user\nexport const updateUser = async (user) => {\n    return await users.update(user._id, user, {});\n}\n\n// call api to patch user\nexport const patchUser = async (userPartial) => {\n    return await users.patch(userPartial._id, userPartial, {})\n}\n\n// call api to login user\nexport const loginUser = async (username, password) => {\n    try {\n        if (!username && !password) {\n            let auth = await client.reAuthenticate();\n            return {\n                userId: auth.user?._id,\n                username: auth.user?.username,\n                error: false,\n            }\n        } else {\n            let auth = await client.authenticate({\n                strategy: 'local',\n                username: username,\n                password: password,\n            });\n            return {\n                user: auth.user,\n                error: false,\n            }\n        }\n    } catch (error) {\n        console.log(error);\n        let message = error?.message ?? ERROR;\n        return {\n            error: message,\n        };\n    }\n}\n\n// logout user on client\nexport const logout = async () => {\n    return await client.logout();\n}\n\n"]},"metadata":{},"sourceType":"module"}