{"ast":null,"code":"import { ERROR } from \"../errorHandling\";\nimport client from \"../feathersClient\";\nconst users = client.service('users'); // call api to register user\n\nexport const registerUser = async (email, password, firstName, lastName) => {\n  return await users.create({\n    \"email\": email,\n    \"password\": password,\n    \"firstName\": firstName,\n    \"lastName\": lastName,\n    userRole: \"patient\"\n  }, {});\n}; // call api to get users\n\nexport const getUsers = async () => {\n  return users.find().then(u => u.data);\n}; // call api to register user by email\n\nexport const getUser = async email => {\n  return users.find({\n    query: {\n      email: email\n    }\n  }).then(u => u.data.length ? u.data[0] : undefined);\n}; // call api to update user\n\nexport const updateUser = async user => {\n  return await users.update(user._id, user, {});\n}; // call api to patch user\n\nexport const patchUser = async userPartial => {\n  return await users.patch(userPartial._id, userPartial, {});\n}; // call api to login user\n\nexport const loginUser = async (email, password) => {\n  try {\n    if (!email && !password) {\n      var _auth$user, _auth$user2;\n\n      let auth = await client.reAuthenticate();\n      return {\n        userId: (_auth$user = auth.user) === null || _auth$user === void 0 ? void 0 : _auth$user._id,\n        email: (_auth$user2 = auth.user) === null || _auth$user2 === void 0 ? void 0 : _auth$user2.email,\n        error: false\n      };\n    } else {\n      let auth = await client.authenticate({\n        strategy: 'local',\n        email: email,\n        password: password\n      });\n      return {\n        user: auth.user,\n        error: false\n      };\n    }\n  } catch (error) {\n    var _error$message;\n\n    console.log(error);\n    let message = (_error$message = error === null || error === void 0 ? void 0 : error.message) !== null && _error$message !== void 0 ? _error$message : ERROR;\n    return {\n      error: message\n    };\n  }\n}; // logout user on client\n\nexport const logout = async () => {\n  return await client.logout();\n};","map":{"version":3,"sources":["/Users/doscorch/Desktop/cs744 project/healthcare/client/src/auth/usersService.js"],"names":["ERROR","client","users","service","registerUser","email","password","firstName","lastName","create","userRole","getUsers","find","then","u","data","getUser","query","length","undefined","updateUser","user","update","_id","patchUser","userPartial","patch","loginUser","auth","reAuthenticate","userId","error","authenticate","strategy","console","log","message","logout"],"mappings":"AACA,SAASA,KAAT,QAAsB,kBAAtB;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AAEA,MAAMC,KAAK,GAAGD,MAAM,CAACE,OAAP,CAAe,OAAf,CAAd,C,CAEA;;AACA,OAAO,MAAMC,YAAY,GAAG,OAAOC,KAAP,EAAcC,QAAd,EAAwBC,SAAxB,EAAmCC,QAAnC,KAAgD;AACxE,SAAO,MAAMN,KAAK,CAACO,MAAN,CAAa;AAAE,aAASJ,KAAX;AAAkB,gBAAYC,QAA9B;AAAwC,iBAAaC,SAArD;AAAgE,gBAAYC,QAA5E;AAAsFE,IAAAA,QAAQ,EAAE;AAAhG,GAAb,EAA0H,EAA1H,CAAb;AACH,CAFM,C,CAIP;;AACA,OAAO,MAAMC,QAAQ,GAAG,YAAY;AAChC,SAAOT,KAAK,CAACU,IAAN,GAAaC,IAAb,CAAkBC,CAAC,IAAIA,CAAC,CAACC,IAAzB,CAAP;AACH,CAFM,C,CAIP;;AACA,OAAO,MAAMC,OAAO,GAAG,MAAOX,KAAP,IAAiB;AACpC,SAAOH,KAAK,CAACU,IAAN,CAAW;AACdK,IAAAA,KAAK,EAAE;AACHZ,MAAAA,KAAK,EAAEA;AADJ;AADO,GAAX,EAIJQ,IAJI,CAICC,CAAC,IAAIA,CAAC,CAACC,IAAF,CAAOG,MAAP,GAAgBJ,CAAC,CAACC,IAAF,CAAO,CAAP,CAAhB,GAA4BI,SAJlC,CAAP;AAKH,CANM,C,CAQP;;AACA,OAAO,MAAMC,UAAU,GAAG,MAAOC,IAAP,IAAgB;AACtC,SAAO,MAAMnB,KAAK,CAACoB,MAAN,CAAaD,IAAI,CAACE,GAAlB,EAAuBF,IAAvB,EAA6B,EAA7B,CAAb;AACH,CAFM,C,CAIP;;AACA,OAAO,MAAMG,SAAS,GAAG,MAAOC,WAAP,IAAuB;AAC5C,SAAO,MAAMvB,KAAK,CAACwB,KAAN,CAAYD,WAAW,CAACF,GAAxB,EAA6BE,WAA7B,EAA0C,EAA1C,CAAb;AACH,CAFM,C,CAIP;;AACA,OAAO,MAAME,SAAS,GAAG,OAAOtB,KAAP,EAAcC,QAAd,KAA2B;AAChD,MAAI;AACA,QAAI,CAACD,KAAD,IAAU,CAACC,QAAf,EAAyB;AAAA;;AACrB,UAAIsB,IAAI,GAAG,MAAM3B,MAAM,CAAC4B,cAAP,EAAjB;AACA,aAAO;AACHC,QAAAA,MAAM,gBAAEF,IAAI,CAACP,IAAP,+CAAE,WAAWE,GADhB;AAEHlB,QAAAA,KAAK,iBAAEuB,IAAI,CAACP,IAAP,gDAAE,YAAWhB,KAFf;AAGH0B,QAAAA,KAAK,EAAE;AAHJ,OAAP;AAKH,KAPD,MAOO;AACH,UAAIH,IAAI,GAAG,MAAM3B,MAAM,CAAC+B,YAAP,CAAoB;AACjCC,QAAAA,QAAQ,EAAE,OADuB;AAEjC5B,QAAAA,KAAK,EAAEA,KAF0B;AAGjCC,QAAAA,QAAQ,EAAEA;AAHuB,OAApB,CAAjB;AAKA,aAAO;AACHe,QAAAA,IAAI,EAAEO,IAAI,CAACP,IADR;AAEHU,QAAAA,KAAK,EAAE;AAFJ,OAAP;AAIH;AACJ,GAnBD,CAmBE,OAAOA,KAAP,EAAc;AAAA;;AACZG,IAAAA,OAAO,CAACC,GAAR,CAAYJ,KAAZ;AACA,QAAIK,OAAO,qBAAGL,KAAH,aAAGA,KAAH,uBAAGA,KAAK,CAAEK,OAAV,2DAAqBpC,KAAhC;AACA,WAAO;AACH+B,MAAAA,KAAK,EAAEK;AADJ,KAAP;AAGH;AACJ,CA3BM,C,CA6BP;;AACA,OAAO,MAAMC,MAAM,GAAG,YAAY;AAC9B,SAAO,MAAMpC,MAAM,CAACoC,MAAP,EAAb;AACH,CAFM","sourcesContent":["\nimport { ERROR } from \"../errorHandling\";\nimport client from \"../feathersClient\";\n\nconst users = client.service('users');\n\n// call api to register user\nexport const registerUser = async (email, password, firstName, lastName) => {\n    return await users.create({ \"email\": email, \"password\": password, \"firstName\": firstName, \"lastName\": lastName, userRole: \"patient\" }, {});\n}\n\n// call api to get users\nexport const getUsers = async () => {\n    return users.find().then(u => u.data)\n}\n\n// call api to register user by email\nexport const getUser = async (email) => {\n    return users.find({\n        query: {\n            email: email\n        }\n    }).then(u => u.data.length ? u.data[0] : undefined)\n}\n\n// call api to update user\nexport const updateUser = async (user) => {\n    return await users.update(user._id, user, {});\n}\n\n// call api to patch user\nexport const patchUser = async (userPartial) => {\n    return await users.patch(userPartial._id, userPartial, {})\n}\n\n// call api to login user\nexport const loginUser = async (email, password) => {\n    try {\n        if (!email && !password) {\n            let auth = await client.reAuthenticate();\n            return {\n                userId: auth.user?._id,\n                email: auth.user?.email,\n                error: false,\n            }\n        } else {\n            let auth = await client.authenticate({\n                strategy: 'local',\n                email: email,\n                password: password,\n            });\n            return {\n                user: auth.user,\n                error: false,\n            }\n        }\n    } catch (error) {\n        console.log(error);\n        let message = error?.message ?? ERROR;\n        return {\n            error: message,\n        };\n    }\n}\n\n// logout user on client\nexport const logout = async () => {\n    return await client.logout();\n}\n\n"]},"metadata":{},"sourceType":"module"}